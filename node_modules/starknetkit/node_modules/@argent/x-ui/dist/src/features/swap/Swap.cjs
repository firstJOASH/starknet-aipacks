"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("react/jsx-runtime"),R=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/tokens/prettifyTokenAmount.cjs"),b=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/utils/number/prettifyNumber.cjs"),U=require("@argent/x-shared/swap"),E=require("../icons/FilterSecondaryIcon.cjs"),u=require("@chakra-ui/react"),C=require("react"),_=require("react-i18next"),j=require("../../components/CompoundInputDeprecated/index.cjs"),D=require("./SwapDetails.cjs"),V=require("./SwapSwitchDirectionButton.cjs"),T=require("./types.cjs"),S=require("../../components/CompoundDialogBottomSheet/index.cjs"),q=require("../../components/CompoundInput/index.cjs"),A=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/bigdecimal/formatUnits.cjs"),W=require("../../components/typography.generated.cjs");function H({assetSelect:p,slippage:r,pay:a,receive:m,onSwitchTokens:O,error:y,isDisabled:N,showDetails:F,trade:e,isLoadingTrade:l,submitButton:w={show:!0,type:"submit"}}){var k;const{t:o}=_.useTranslation(),h=((k=r.options)==null?void 0:k.multiplier)||100,{isOpen:P,onOpen:d,onClose:x}=u.useDisclosure(),{isOpen:B,onOpen:f,onClose:I}=u.useDisclosure(),[M,s]=C.useMemo(function(){if(e){const t=A.formatUnits({value:BigInt(e.payAmount),decimals:e.payToken.decimals??18}),i=A.formatUnits({value:BigInt(e.receiveAmount),decimals:e.receiveToken.decimals??18}),v=b.prettifyCurrencyNumber(Number(i)/Number(t));let c=!!(e.payAmountInCurrency&&e.receiveAmountInCurrency&&Number(e.payAmountInCurrency)!==0&&Number(e.receiveAmountInCurrency)!==0)?(Number(e.payAmountInCurrency)-Number(e.receiveAmountInCurrency))/Number(e.receiveAmountInCurrency)*100:null;return c=c===null||c===0?c:c*-1,[v,c]}return[null,null]},[e]),g=C.useMemo(function(){var t;if(e){const{value:i,decimals:v}=U.minimumAmountOutFromTrade(e,r.value);return R.prettifyTokenAmount({amount:i,decimals:v,symbol:(t=e.receiveToken)==null?void 0:t.symbol})}},[e,r]),$=C.useMemo(function(){if(e){const t=[{property:o("swap.swapFee"),value:`${e.totalFeePercentage*100}%`},{property:o("swap.minReceivedInclFees"),value:`${g}`},{property:o("swap.maxSlippage"),value:(r.value/h).toString(),buttonProps:{icon:n.jsx(E,{}),"aria-label":"some label",onClick:f},alert:r.value/h>1?o("swap.yourTransactionMayBeFrontrunAndResultInAnUnfavorableTrade"):""},{property:o("swap.providers"),value:e.route.name}];return s?t.push({property:o("swap.priceImpact"),value:`${b.prettifyNumber(s)}%`,alert:s&&s<-1?o("swap.yourTradeWillHaveASignificantImpactOnThePrice"):""}):e&&s===null&&t.push({property:o("swap.priceImpact"),value:"",alert:o("swap.noPriceFoundCannotDeterminePriceImpact")}),t}return[]},[e,g,r.value,h,f,s,o]);return n.jsxs(n.Fragment,{children:[n.jsx(S.CompoundDialogBottomSheet,{isOpen:P,onClose:()=>x(),bottomSheetProps:{expandOnContentDrag:!0,snapPoints:({maxHeight:t})=>[t-(p.bottomSheetTopMargin??80)/2]},children:n.jsx(S.CompoundDialogBottomSheet.SelectAsset,{loading:p.loading,tokens:p.tokens,onSelect:t=>{p.onSelect(t),x()}})}),n.jsx(S.CompoundDialogBottomSheet,{isOpen:B,onClose:()=>I(),bottomSheetProps:{expandOnContentDrag:!0},children:n.jsx(S.CompoundDialogBottomSheet.SlippageInput,{onSave:t=>{r.onSave(t),I()},value:r.value,options:r.options})}),n.jsxs(u.Flex,{direction:"column",gap:"4",children:[n.jsxs(u.Flex,{w:"full",direction:"column",gap:"1",children:[n.jsxs(u.Flex,{pos:"relative",children:[n.jsx(q.CompoundInput,{amount:a.amount,token:{...a.token,onClick:t=>{var i;(i=a.token)==null||i.onClick(t),d()}},isLoading:a.isLoading,children:n.jsx(j.CompoundInputDeprecated.Default,{title:o("swap.pay")})}),n.jsx(V.SwapSwitchDirectionButton,{onClick:O})]}),n.jsx(q.CompoundInput,{amount:m.amount,token:{...m.token,onClick:t=>{var i;(i=m.token)==null||i.onClick(t),d()}},isLoading:m.isLoading,children:n.jsx(j.CompoundInputDeprecated.Default,{title:o("swap.receive")})})]}),!e&&l&&n.jsxs(u.Flex,{bg:"surface-elevated",justifyContent:"space-between",alignItems:"center",p:"4",rounded:"lg",fontWeight:"500",children:[n.jsx(W.P3,{children:o("swap.findingTheBestRate")}),n.jsx(u.Spinner,{})]}),F&&e&&n.jsx(D.SwapDetails,{children:n.jsx(D.SwapDetails.Default,{header:{primary:{property:o("swap.bestPrice"),value:`1 ${e.payToken.symbol} = ${M} ${e.receiveToken.symbol}`},secondary:{property:o(l?"swap.updatingQuote":"swap.quoteUpToDate"),icon:l?n.jsx(u.Spinner,{w:"2",h:"2"}):void 0}},items:$})})]}),w.show&&n.jsx(u.Button,{type:w.type,onClick:w.onClick,colorScheme:!l&&y&&![T.SwapInputError.NO_TOKEN,T.SwapInputError.NO_AMOUNT].includes(y)?"danger":"primary",w:"full",isDisabled:N,children:o(l?"swap.loading":y||"swap.review")})]})}exports.Swap=H;
