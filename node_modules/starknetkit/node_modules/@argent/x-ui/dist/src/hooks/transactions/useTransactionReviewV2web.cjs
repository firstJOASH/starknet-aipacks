"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/chains/starknet/address.cjs"),N=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/tokens/balances.cjs"),H=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/transactions/estimate/utils.cjs"),I=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/utils/arrays.cjs"),G=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/utils/hex.cjs"),M=require("react"),b=async({feeTokenAddress:e,calls:o,selectedAccount:r,transactionReviewService:c,appDomain:t,accountDeployTransaction:a,isDelayedTransaction:u})=>{const l={type:"INVOKE",calls:I.ensureArray(o)};if(!r||!e)return;const s=a?[a,l]:[l];return{result:await c.simulateAndReview(r,s,e,t,a,u)}},k=async(e,o,r,c)=>{var g,y,F,T,w,A;let t=!1;const a=(g=o.transactions)==null?void 0:g.find(n=>{var q,B;return(B=(q=n==null?void 0:n.simulation)==null?void 0:q.summary)==null?void 0:B.find(x=>x.sent)});if(!a||!((y=a.simulation)!=null&&y.summary))return t;const u=await N.getTokenBalance(r,e,c)??0n,l=a.simulation.summary.filter(n=>n.sent).map(n=>n.token.address),s=(F=o.enrichedFeeEstimation)==null?void 0:F.find(n=>h.isEqualAddress(n.transactions.feeTokenAddress,r)),i=(s==null?void 0:s.transactions.feeTokenAddress)&&l.includes(s.transactions.feeTokenAddress),d=(s==null?void 0:s.type)==="native"&&!(s!=null&&s.transactions.l1Gas.gasConsumed||s!=null&&s.transactions.l2Gas.gasConsumed||s!=null&&s.transactions.l1DataGas.gasConsumed),R=(s==null?void 0:s.type)==="paymaster"&&!((T=s.transactions)!=null&&T.maxFee);if(!i||d&&R)return t;const m=H.estimatedFeesToMaxFeeTotalV2(s),v=(w=a.simulation.summary.find(n=>n.sent&&h.isEqualAddress(n.token.address,r)))==null?void 0:w.value,S=(A=a.simulation.summary.find(n=>!n.sent&&h.isEqualAddress(n.token.address,r)))==null?void 0:A.value;if(!m||!v)return t;const C=BigInt(v)-BigInt(S||0);if(!u)return t;const f=m+C;return u>=f||(t=!0),t},O=()=>M.useCallback(async({feeTokenAddress:o,calls:r,selectedAccount:c,transactionReviewService:t,appDomain:a,accountDeployPayload:u,provider:l,isDelayedTransaction:s})=>{if(!c)return;const i=await b({feeTokenAddress:o,calls:r,selectedAccount:c,transactionReviewService:t,appDomain:a,accountDeployTransaction:p(u),isDelayedTransaction:s});if(!i||!i.result||!o)return;const d=await k(c.address,i.result,o,l);return{...i.result,isSendingMoreThanBalanceAndGas:d}},[]),p=e=>e?{type:"DEPLOY_ACCOUNT",calldata:e.calldata,classHash:G.hexSchema.parse(e.class_hash),salt:G.hexSchema.parse(e.salt),signature:[]}:void 0;exports.buildAccountDeployTransaction=p;exports.checkGasFeeBalance=k;exports.getReviewForTransactions=b;exports.useTransactionReviewV2webFetcher=O;
