"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("../../../node_modules/.pnpm/@argent_x-shared@1.73.0_@scure_base@1.2.4_@scure_bip39@1.5.4_async-retry@1.3.3_lodash-e_b34e798a09d95058b17e0b32da902dbd/node_modules/@argent/x-shared/dist/src/http/fetcher.cjs"),s=require("lodash-es"),w=require("object-hash"),o=require("react"),d=require("url-join"),g=require("../../http/swr.cjs"),l=({apiData:{apiBaseUrl:e,apiHeaders:n},address:t,network:r,transactionReviewEnabled:c=!0,transactions:i})=>{const u=o.useCallback(async()=>{if(!t||!r)return;if(!e)throw"Transaction review endpoint is not defined";const T=d(e,"reviewer/transactions/review/starknet"),v=s.isArray(i)?i:[i],f={network:r,account:t,calls:v};return p.fetchData(T,{method:"POST",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(f)})},[t,r,i]),y=o.useMemo(()=>w({transactions:i,address:t,network:r}),[i,t,r]);return g.useConditionallyEnabledSWR(!!c,[y,"transactionReview"],u)},h=e=>{if(!e)return{};const n=e.assessment==="warn"&&e.reason!=="contract_is_not_verified",t=e.reason?` (Reason: ${s.lowerCase(e.reason)})`:"",r=n?e.reason==="recipient_is_token_address"?"You are sending tokens to their own address. This is likely to burn them.":`This transaction has been flagged as dangerous. We recommend you reject this transaction unless you are sure.${t}`:void 0;return{warn:n,reason:r}},a=e=>{var n;if(e){for(const t of e.reviews)if(((n=t.activity)==null?void 0:n.type)==="swap")return t}},R=e=>{},A=(e,n)=>{var t;if(n){for(const r of n.reviews)if(((t=r.activity)==null?void 0:t.type)===e)return r.activity}},S=e=>!!a(e),_=e=>{var n,t;if(e){for(const r of e.reviews)if((n=r.activity)!=null&&n.type)return{...r,type:(t=r.activity)==null?void 0:t.type}}};exports.getDisplayWarnAndReasonForTransactionReview=h;exports.getNFTTransferActivity=R;exports.getTransactionReviewActivityOfType=A;exports.getTransactionReviewHasSwap=S;exports.getTransactionReviewSwap=a;exports.getTransactionReviewWithType=_;exports.useTransactionReview=l;
