"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("react/jsx-runtime"),p=require("../../features/icons/EmptyFaceSecondaryIcon.cjs"),d=require("@chakra-ui/react"),I=require("lightweight-charts"),R=require("lodash-es"),r=require("react"),T=require("react-i18next");require("../Typography.cjs");const z=require("./utils.cjs"),H=require("../typography.generated.cjs"),M=({tokenGraphData:c,isLoading:x,chartOptions:h,getSeriesConfig:v,markerColor:g,asset:W,onCrosshairMove:u=R.noop,children:w,...E})=>{const{t:a}=T.useTranslation(),i=r.useRef(null),o=r.useRef(null),t=r.useRef(null),j=d.useColorModeValue("neutrals.400","neutrals.300"),q=!x&&R.isEmpty(c==null?void 0:c.prices),F=`${h.height}px`,P=r.useCallback(()=>{var e;(e=o.current)==null||e.applyOptions({color:"#FFFFFF4D"})},[]),y=r.useCallback(()=>{var n,l;if(!o.current)return;const{prices:e}=z.buildTokenPrices({tokenGraphPrices:c==null?void 0:c.prices.map(f=>({time:f.date,value:f.ccyValue}))});(n=o.current)==null||n.setData(e??[]),(l=i.current)==null||l.timeScale().fitContent()},[c==null?void 0:c.prices]),b=r.useCallback(e=>{if(!t.current)return;const n=t.current.getBoundingClientRect();e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom||u(void 0)},[u]);r.useEffect(()=>(window==null||window.addEventListener("mousemove",b),()=>{window==null||window.removeEventListener("mousemove",b)}),[b]);const m=r.useCallback(e=>{if(!(!t.current||!o.current))if(e.point===void 0||e.point.x<0||e.point.x>t.current.clientWidth||e.point.y<0||e.point.y>t.current.clientHeight)u(void 0);else{const n=e.seriesData.get(o.current),l=n==null?void 0:n.value,f=e.time;l&&f&&u({x:e.point.x,y:e.point.y,time:f,price:l,width:t.current.clientWidth,height:t.current.clientHeight})}},[u]),S=r.useCallback(e=>{t.current=e,t.current&&(i.current&&(i.current.unsubscribeCrosshairMove(m),i.current.remove()),i.current=I.createChart(t.current,h),o.current=i.current.addLineSeries(v(g)),i.current.subscribeCrosshairMove(m),y())},[h,v,y,g,m]),C=r.useCallback(()=>{var e;i.current&&(i.current.applyOptions({width:(e=t.current)==null?void 0:e.clientWidth}),i.current.timeScale().fitContent())},[]);return r.useEffect(()=>(window==null||window.addEventListener("resize",C),()=>{window==null||window.removeEventListener("resize",C)}),[C]),s.jsxs(d.Box,{minHeight:F,position:"relative",onTouchEnd:e=>{e.preventDefault(),u(void 0)},sx:{touchAction:"none"},onMouseEnter:P,...E,children:[!x&&s.jsx(d.Box,{ref:S,mx:"-4"}),q&&s.jsxs(d.Flex,{flexDir:"column",justifyContent:"center",alignItems:"center",h:"full",children:[s.jsx(d.Skeleton,{h:"90%",mx:5,borderRadius:"xl"})," ",s.jsx(p,{color:j,w:"5",h:"5",gap:"2"}),s.jsx(H.P3,{fontSize:"sm",fontWeight:"semibold",children:a("tokenDetailsChart.noPriceAvailable")})]}),x&&s.jsx(d.Skeleton,{h:"90%",mx:5,borderRadius:"xl"}),w]})};exports.TokenDetailsChart=M;
